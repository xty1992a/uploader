!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Uploader",[],t):"object"==typeof exports?exports.Uploader=t():e.Uploader=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=function(e,t,n,o){return new Promise(function(r,i){var a=new XMLHttpRequest;a.open(n||"POST",e),a.send(t),a.onreadystatechange=function(){4===a.readyState&&(a.status>=200&&a.status<300?r(function(e){var t=e;try{t=JSON.parse(e)}catch(e){console.log(e)}return t}(a.responseText)):(console.log("Error: "+a.status),i(a.status)))},a.upload.onprogress=function(e){e.lengthComputable&&o&&o(Math.floor(e.loaded/e.total*100))}})},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=function(){function e(){u(this,e),this.task={}}return a(e,[{key:"on",value:function(e,t){this.task[e]=t}},{key:"fire",value:function(e,t){this.task[e]&&this.task[e](t)}}]),e}(),l={uploadUrl:"/",fileName:"file",stop:!0,getFormData:void 0,responseFormat:function(e){return e.data},deleteRequest:void 0,el:void 0},c=function(e){function t(e){u(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.fileChangeHandler=function(e){var t=e.target.files||e.dataTransfer.files;if(!t.length)return!1;n.uploadFile(t[0])},n.uploadFile=function(e){!e instanceof Blob||n.uploadRequest(e).then(function(e){n.fire("upload",e)}).catch(function(e){n.fire("upload-error",e)})},n.uploadRequest=function(e){return new Promise(function(t,r){n.$options.upload?n.$options.upload(e,function(e,n){e?r(e):t(n)}):n.generateForm(e).then(function(e){return o(n.$options.uploadUrl,e)}).then(function(e){t(i({},e,{formData:n.formData}))}).catch(r)})},n.$options=i({},l,e),n.bindEl(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,f),a(t,[{key:"bindEl",value:function(){var e=this.$options.el;e instanceof Element&&("input"===e.tagName.toLowerCase()&&"file"===e.type?e.addEventListener("change",this.fileChangeHandler):(e.style.overflow="hidden",e.style.position="relative",e.appendChild(this.generateFile())))}},{key:"generateFile",value:function(){var e=document.createElement("input");return e.type="file",e.addEventListener("change",this.fileChangeHandler),e.style.position="absolute",e.style.left=0,e.style.right=0,e.style.top=0,e.style.bottom=0,e.style.width="100%",e.style.height="100%",e.style.opacity=0,this.$options.stop&&e.addEventListener("click",function(e){e.stopPropagation()}),e}},{key:"generateForm",value:function(e){var t=this;return new Promise(function(n){t.getFormData(e).then(function(o){o.append(t.$options.fileName,e),n(o)})})}},{key:"getFormData",value:function(e){var t=this;return new Promise(function(n){var o=new FormData,i=t.$options,a=i.getFormData,u=i.getFormDataAsync;if("function"==typeof a){var f=a(e);return"object"===(void 0===f?"undefined":r(f))&&(t.formData=f,Object.keys(f).forEach(function(e){o.append(e,f[e])})),void n(o)}"function"!=typeof u?n(o):u(function(e){"object"===(void 0===e?"undefined":r(e))&&(t.formData=e,Object.keys(e).forEach(function(t){o.append(t,e[t])})),n(o)},e)})}}]),t}();t.default=c}]).default});